{"title":"RMD sample","markdown":{"yaml":{"title":"RMD sample","author":"Michael Hudson-Vassell","date":"2023-10-08","output":"html_document"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE)\nlibrary(tidyverse)\nlibrary(timetk)\nlibrary(rvest)  # required for web scraping\nlibrary(knitr)\nlibrary(scales)\nlibrary(lubridate)\n\n```\n\n\nI've created this document to demonstrate a useful approach for systematic reporting when you have data that resides in multiple locations. This approach allows organizations to avoid the potential pitfalls of transcribing totals and percentages by hand, supporting the continued accuracy and consistency of reporting on mission-critical metrics. This approach is possible because companies that host online data platforms (Procare, Qualtrics, etc.) typically publish APIs that allow their users to analyze relevant data directly from statistical analysis programs (like R) using required login credentials.\n\nIn the examples contained within this document, I pull information on companies in the S&P 500 market index from Wikipedia, which provides general information about the companies that constitute the S&P 500. This approach can be adapted to local reports on student enrollments and learning outcomes, among a variety of other applications.\n\n```{r get Wiki data, echo=FALSE}\n# Go to the website and read the html page\nurl <- \"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\"\nurl <- read_html(url)\n\n# Get the correct data table, \n# We want the table which has\n# the constituents\nwiki_data <- url %>%\n  html_nodes(\"#constituents td\") %>%\n  html_text()\n\n# After getting the data\n# Convert the vector into a matrix\n\nwiki_data <- matrix(wiki_data, ncol = 8, byrow = TRUE)\n\n# Convert the matrix into a tibble\nwiki_data <- data.frame(wiki_data, stringsAsFactors = FALSE) %>%\n  tk_tbl()\n\n#rename columns\ncolnames(wiki_data) <- c(\"symbol\",\"security\",\"GICS_sector\",\n                        \"GICS_subindustry\",\"hq\",\"date_added\",\n                        \"CIK\",\"founded\")\n```\n\n## Tables\n\nBelow you'll see a sample of what the underlying Wikipedia table looks like. We'll be using this table to report on the general construction and key characteristics of the S&P 500 index.\n\n```{r wiki head, echo=FALSE}\nkable(head(wiki_data))\n```\n\nUsing the information contained in the table, we can look at & compare counts across groups, filter subgroups for closer analysis (e.g., examine student outcomes at a specific site), and highlight any information that the leadership team identifies as especially important.\n\n## Charts\n\nThe bar graph below shows counts by sector across the S&P 500 companies. In an education setting, such a chart could show student enrollments across sites, changes in enrollment over a specific time frame across those sites, or a plethora of other useful information.\n\n```{r wiki counts plot, echo=FALSE}\n# create bar blot of SP500 firms by sector\nggplot(wiki_data, aes(x=GICS_sector, fill=GICS_sector))+\n  geom_bar(stat=\"count\") +\n  theme(axis.text.x = element_text(angle = 90))\n```\n\n## Embedding data\n\nIt's also possible to embed calculated totals within the text of the report. This allows for the seamless updating of counts for common items (e.g., average counts, test scores) over time without needing to transcribe anything by hand.\n\n### Calculated totals & percentages\n\nHere's a simple example of the types of underlying calculations that could occur, including group counts and percentages.\n\n```{r wiki counts calc, echo=FALSE}\n# count SP500 firms by sector\nwiki_counts <- wiki_data %>%\n  group_by(GICS_sector) %>%\n  summarize(count = n()) %>%\n  arrange(desc(count))%>%\n  ungroup() %>%\n  mutate(pct = percent(count/sum(count),accuracy=1))\n\nkable(wiki_counts)\n```\n\n### Embedding data in descriptions and explanations\n\nAfter calculations are complete, we can call out specific data points of interest and embed them within our reports. The paragraph below shows how such embedded totals would look in the report **(embedded date/time, data, and totals italicized for emphasis):**\n\n> The list of S&P 500 firms, as of *`r format(Sys.Date(), format = \"%B %d %Y\")`,* includes *`r wiki_counts$GICS_sector[1]`,* *`r wiki_counts$GICS_sector[2]`,* *`r wiki_counts$GICS_sector[3]`,* and *`r wiki_counts$GICS_sector[4]`* as its largest sectors. These sectors currently constitute *`r wiki_counts$pct[1]`,* *`r wiki_counts$pct[2]`,* *`r wiki_counts$pct[3]`,* and *`r wiki_counts$pct[4]`* of the total number of firms, respectively.\n\n**Here's an example without italics:**\n\n> The list of S&P 500 firms, as of `r format(Sys.Date(), format = \"%B %d %Y\")`, includes `r wiki_counts$GICS_sector[1]`, `r wiki_counts$GICS_sector[2]`, `r wiki_counts$GICS_sector[3]`, and `r wiki_counts$GICS_sector[4]` as its largest sectors. These sectors currently constitute `r wiki_counts$pct[1]`, `r wiki_counts$pct[2]`, `r wiki_counts$pct[3]`, and `r wiki_counts$pct[4]` of the total number of firms, respectively.","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE)\nlibrary(tidyverse)\nlibrary(timetk)\nlibrary(rvest)  # required for web scraping\nlibrary(knitr)\nlibrary(scales)\nlibrary(lubridate)\n\n```\n\n## Introduction\n\nI've created this document to demonstrate a useful approach for systematic reporting when you have data that resides in multiple locations. This approach allows organizations to avoid the potential pitfalls of transcribing totals and percentages by hand, supporting the continued accuracy and consistency of reporting on mission-critical metrics. This approach is possible because companies that host online data platforms (Procare, Qualtrics, etc.) typically publish APIs that allow their users to analyze relevant data directly from statistical analysis programs (like R) using required login credentials.\n\nIn the examples contained within this document, I pull information on companies in the S&P 500 market index from Wikipedia, which provides general information about the companies that constitute the S&P 500. This approach can be adapted to local reports on student enrollments and learning outcomes, among a variety of other applications.\n\n```{r get Wiki data, echo=FALSE}\n# Go to the website and read the html page\nurl <- \"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\"\nurl <- read_html(url)\n\n# Get the correct data table, \n# We want the table which has\n# the constituents\nwiki_data <- url %>%\n  html_nodes(\"#constituents td\") %>%\n  html_text()\n\n# After getting the data\n# Convert the vector into a matrix\n\nwiki_data <- matrix(wiki_data, ncol = 8, byrow = TRUE)\n\n# Convert the matrix into a tibble\nwiki_data <- data.frame(wiki_data, stringsAsFactors = FALSE) %>%\n  tk_tbl()\n\n#rename columns\ncolnames(wiki_data) <- c(\"symbol\",\"security\",\"GICS_sector\",\n                        \"GICS_subindustry\",\"hq\",\"date_added\",\n                        \"CIK\",\"founded\")\n```\n\n## Tables\n\nBelow you'll see a sample of what the underlying Wikipedia table looks like. We'll be using this table to report on the general construction and key characteristics of the S&P 500 index.\n\n```{r wiki head, echo=FALSE}\nkable(head(wiki_data))\n```\n\nUsing the information contained in the table, we can look at & compare counts across groups, filter subgroups for closer analysis (e.g., examine student outcomes at a specific site), and highlight any information that the leadership team identifies as especially important.\n\n## Charts\n\nThe bar graph below shows counts by sector across the S&P 500 companies. In an education setting, such a chart could show student enrollments across sites, changes in enrollment over a specific time frame across those sites, or a plethora of other useful information.\n\n```{r wiki counts plot, echo=FALSE}\n# create bar blot of SP500 firms by sector\nggplot(wiki_data, aes(x=GICS_sector, fill=GICS_sector))+\n  geom_bar(stat=\"count\") +\n  theme(axis.text.x = element_text(angle = 90))\n```\n\n## Embedding data\n\nIt's also possible to embed calculated totals within the text of the report. This allows for the seamless updating of counts for common items (e.g., average counts, test scores) over time without needing to transcribe anything by hand.\n\n### Calculated totals & percentages\n\nHere's a simple example of the types of underlying calculations that could occur, including group counts and percentages.\n\n```{r wiki counts calc, echo=FALSE}\n# count SP500 firms by sector\nwiki_counts <- wiki_data %>%\n  group_by(GICS_sector) %>%\n  summarize(count = n()) %>%\n  arrange(desc(count))%>%\n  ungroup() %>%\n  mutate(pct = percent(count/sum(count),accuracy=1))\n\nkable(wiki_counts)\n```\n\n### Embedding data in descriptions and explanations\n\nAfter calculations are complete, we can call out specific data points of interest and embed them within our reports. The paragraph below shows how such embedded totals would look in the report **(embedded date/time, data, and totals italicized for emphasis):**\n\n> The list of S&P 500 firms, as of *`r format(Sys.Date(), format = \"%B %d %Y\")`,* includes *`r wiki_counts$GICS_sector[1]`,* *`r wiki_counts$GICS_sector[2]`,* *`r wiki_counts$GICS_sector[3]`,* and *`r wiki_counts$GICS_sector[4]`* as its largest sectors. These sectors currently constitute *`r wiki_counts$pct[1]`,* *`r wiki_counts$pct[2]`,* *`r wiki_counts$pct[3]`,* and *`r wiki_counts$pct[4]`* of the total number of firms, respectively.\n\n**Here's an example without italics:**\n\n> The list of S&P 500 firms, as of `r format(Sys.Date(), format = \"%B %d %Y\")`, includes `r wiki_counts$GICS_sector[1]`, `r wiki_counts$GICS_sector[2]`, `r wiki_counts$GICS_sector[3]`, and `r wiki_counts$GICS_sector[4]` as its largest sectors. These sectors currently constitute `r wiki_counts$pct[1]`, `r wiki_counts$pct[2]`, `r wiki_counts$pct[3]`, and `r wiki_counts$pct[4]` of the total number of firms, respectively."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"project1.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.24","theme":["cosmo","brand"],"title":"RMD sample","author":"Michael Hudson-Vassell","date":"2023-10-08"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}